# AcIMS 画面設計書

**プロジェクト:** AcIMS (Account Information Management System)  
**作成日:** 2025/11/21  
**フレームワーク:** Windows Forms (.NET 8)

---

# 1. 画面一覧

| 画面名称 | 物理ファイル名(案) | 概要 |
| :--- | :--- | :--- |
| マスターパスワード設定画面 | `SetupForm.cs` | 初回起動時の設定、またはPW変更時に使用 |
| パスワード入力画面 | `LoginForm.cs` | アプリ起動時の認証画面 |
| 管理画面（メイン画面） | `MainForm.cs` | アカウント一覧表示・検索・CRUD操作 |
| 設定画面 | `SettingsForm.cs` | アプリの挙動設定、データ管理 |
| パスワード生成画面 | `CreatePassWord.cs` | ランダムパスワード生成ツール |

---

# 2. 詳細設計

### マスターパスワード設定画面
**概要:**
アプリの初回起動時、または設定画面から「パスワード変更」を選択した際に表示される。
データファイルを暗号化するためのマスターキーを設定する。

**主要コントロール:**
| ID | 種類 | プロパティ設定 | 説明 |
| :--- | :--- | :--- | :--- |
| `changeNewPassword` | TextBox | `PasswordChar = '●'` | 新しいパスワード入力欄 |
| `isViewPasswordCheckBox` | checkbox | `PasswordChar = False` | パスワードを表示する |
| `confirmPasswordTextBox` | TextBox | `PasswordChar = '●'` | 確認用再入力欄 |
| `isViewPasswordCheckBox` | checkbox | `PasswordChar = False` | 確認パスワードを表示する |
| `changePsswordBtn` | Button | `Text = "確認"` | 確認ボタン |
| `ManualLink` | label | `Text = "使い方"` | マニュアルが記載されているWebページへ遷移する |

**処理ロジック:**
1.  **changePsswordBtn:**
    * バリデーション: `isViewPasswordCheckBox` と `isViewPasswordCheckBox` が一致すること。空文字でないこと。
    * **[初回起動時]**
        * 空のデータリストを作成。
        * 入力されたPWで暗号化キーを生成し、空のXMLファイルを作成して保存。
        * 管理画面（メイン画面）へ遷移。
    * **[変更時]**
        * メモリ上の既存データを、新しいPWで再暗号化して上書き保存。
        * 画面を閉じる。

<img src="..\document\img\changepasswordform.png" alt="画像の説明">

---

### パスワード入力画面
**概要:**
アプリ起動時に表示。正しいパスワードが入力されるまでメイン機能をロックする。

**主要コントロール:**
| ID | 種類 | プロパティ設定 | 説明 |
| :--- | :--- | :--- | :--- |
| `passwordText` | TextBox | `PasswordChar = '●'` | パスワード入力欄 |
| `isViewPassword` | CheckBox | - | 「パスワードを表示する」 |
| `confirmBtn` | Button | `ConfirmBtn` | 確認 |
| `ManualLink` | label | `Text = "使い方"` | マニュアルが記載されているWebページへ遷移する |

**処理ロジック:**
1.  **btnLogin_Click:**
    * 入力PWを使ってローカルXMLファイルの復号化(`Decrypt`)を試行。
    * **[成功]** 復号データをメモリ(`List<AccountItem>`)に展開し、管理画面(メイン画面)を表示。
    * **[失敗]** `CryptographicException` をキャッチし、「パスワードが違います」とMsgBox表示。
2.  **chkShowPass_CheckedChanged:**
    * ON: `txtPassword.PasswordChar = '\0'` (表示)
    * OFF: `txtPassword.PasswordChar = '*'` (伏せ字)

<img src="..\document\img\certificationform.png" alt="画像の説明">

---

### 管理画面（メイン画面）
**概要:**
データの一覧表示と操作の中心となる画面。検索、追加、編集、削除を行う。

**主要コントロール:**
| ID | 種類 | プロパティ設定 | 説明 |
| :--- | :--- | :--- | :--- |
| `ManualLink` | label | `Text = "使い方"` | マニュアルが記載されているWebページへ遷移する |
| `viewPassword` | checkbox | `Text = "全てのパスワードを表示"` | 全てのパスワードのマスクを外す |
| `currentViewPasswordCheckBox` | checkbox | `Text = "パスワードを表示"` | 選択している行のパスワードのマスクを外す |
| `dataGrid` | DataGridView | - | 各種アカウント情報を表示する |
| `Category` | ComboBox | `Text = ""` | 保存されているカテゴリから一覧化して絞り込み検索が出来る |
| `searchBtn` | Button | `Text = "検索"` | searchTextBoxに入力された情報を元に保存されたデータから類似するデータを検索する |
| `searchTextBox` | TextBox | `Text = ""` | 検索する関連ワードを入力するUI |
| `IDClip` | Button | `Text = "ID取得"` | 選択している行のIDの情報をクリップボードにコピーする |
| `MailClip` | Button | `Text = "メールアドレス取得"` | 選択している行のメールアドレスの情報をクリップボードにコピーする |
| `PassClip` | Button | `Text = "パスワード取得"` | 選択している行のパスワードの情報を内部のデータから参照し、クリップボードにコピーする |
| `URLButton` | Button | `Text = "URLを取得"` | 選択している行のURLの情報をクリップボードにコピーする |
| `Browser` | Button | `Text = "ブラウザ起動"` | 選択している行のURLの情報を元に既定のWebブラウザから検索を実行する |
| `DeleteButton` | Button | `Text = "削除"` | 選択している行を削除する。※編集モードがONの状態のみ活性状態になる。 |
| `EditMode` | Button | `Text = "パスワード生成"` | パスワード生成画面を起動する |
| `SettingButton` | Button | `Text = "設定"` | 設定画面を起動する |
| `reload` | Button | `Text = "更新"` | 内部データが書き換わった時にこのボタンを押すことで画面の更新処理が走る |

**DataGridViewカラム構成:**
* カテゴリ
* アプリ/サイト名
* ID
* メールアドレス
* パスワード
* URL
* 備考

**処理ロジック:**
1. --

<img src="..\document\img\\mainform.png" alt="画像の説明">

---

### 設定画面
**概要:**
アプリの挙動設定およびマスターパスワードの変更呼び出し。

**主要コントロール:**
| ID | 種類 | プロパティ設定 | 説明 |
| :--- | :--- | :--- | :--- |
| `DeletionNotification` | CheckBox | `Text = "項目削除時の確認通知"` | 削除するときの通知ウィンドウを表示するか制御する |
| `SaveNotification` | CheckBox | `Text = "保存時の通知確認"` | 保存するときの通知ウィンドウを表示するか制御する |
| `AutoSave` | CheckBox |  `Text = "オートセーブ機能"` | オートセーブを実行するか制御する |
| `TimeOut` | CheckBox | `Text = "タイムアウト機能"` |  無操作状態の時にアプリを落とすか制御できる |
| `TimeOutNum` | NumericUpDown |  `Num = 5` | 何分間無操作が続いたらアプリを落とすか制御できる |
| `ChangePassword` | Button |  `Text = "マスターパスワード変更"` | ログイン画面を呼び出してログインができた後にパスワード変更画面を起動する |

**処理ロジック:**
1.  --

<img src="..\document\img\settingform.png" alt="画像の説明">

---

### パスワード生成画面
**概要:**
ランダムなパスワードを生成するユーティリティ。

**主要コントロール:**
| ID | 種類 | 初期値 | 説明 |
| :--- | :--- | :--- | :--- |
| `createPassNum` | NumericUpDown | 8 | 生成する文字数 |
| `isBigEnglishCheckBox` | CheckBox | Checked | 英大文字 (A-Z) |
| `isSmallEnglishCheckBox` | CheckBox | Checked | 英小文字 (a-z) |
| `isNumCheckBox` | CheckBox | Checked | 数字 (0-9) |
| `isSymbolCheckBox` | CheckBox | Unchecked | 記号 (!@#...) |
| `resultBox` | TextBox | - | 生成結果 |
| `createKeyWord` | Button | Text="パスワードの生成" | 生成実行&クリップボードに生成内容をコピー |
| `isViewPassword` | Button | Text="パスワードの表示" | 生成パスワードのマスクを外す |

**処理ロジック:**
1.  --

<img src="..\document\img\createpasswordform.png" alt="画像の説明">

---